.row
  .span10
    %form.well.form-search
      %input{:type => "text", :class => "input-large search-query"}
      %button{:type => "submit", :class => "btn large"}
        Search the cove!

.row
  .span10 
    .accordion#accordion2
      - @topics.each do |topic|
        .accordion-group
          .accordion-heading
            %a{:class => "accordion-toggle", "data-toggle" => "collapse", "data-parent" => "#accordion2", :href => "##{topic.id}"}
              %h2= topic.name
          %div{:id => topic.id, :class => "accordion-body in collapse" }
            .accordion-inner
              %h5 
                - if topic.links.empty?
                  %p 
                    There are no links currently
                    - if current_user
                      = link_to "Add one", new_topic_link_path(topic) 
                    - else
                      = link_to "Please signin to add links", "/auth/twitter"
                    
                - else
                  %ol
                    - topic.links.order('score DESC').each do |link|
                      %li
                        %span.link
                          %a{:href => "#{link.path}", "data-id" => link.id, :target => "_blank"}
                            = link.name
                        = "Score #{link.score}"
                        - if current_user
                          - if already_rated?(link.id, current_user)
                            %p you have already voted on this link
                          - else
                            = link_to "Like", link_ratings_path(:link_id => link.id), :method => :post
                            = link_to "Hate", link_ratings_path(:link_id => link.id, :query => "bad"), :method => :post
                  - if current_user      
                    = link_to "Add a new link", new_topic_link_path(topic)
                  - else
                    = link_to "Please sign to add links", "/auth/twitter"
              = form_for(Link.new(:topic_id => topic.id), :remote => true)   do |f|
                = f.hidden_field :topic_id
                = f.text_field :name
                = f.text_field :path
                = f.submit
